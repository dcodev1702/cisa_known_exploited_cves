#!/bin/bash

# add /usr/bin to path so crontab and python3 don't have to explicitly call /usr/bin
PATH=/usr/bin/:$PATH

touch /var/log/cron.log

# set cron job to run daily at 0600
crontab -l | { cat; echo "0 6 * * * python3 /usr/share/logstash/cisa_cve_compact_json.py"; } | crontab -

# download JSON from CISA CVE Catalog
python3 /usr/share/logstash/cisa_cve_compact_json.py > /proc/1/fd/1 2>/proc/1/fd/2

# Used to keep logstash running
tail -f /dev/null
